{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "definitions": {
    "licenseType" : {
      "type" : "string",
      "enum": ["Trial", "Commercial", "Enterprise", "Educational", "OpenSource", "Internal"]
    },
    "PLK" : {
      "type" : "object",
      "description" : "Plugin License Key - Issued license for plugin access\nUses ECIES: both parties derive symmetric key via X25519 ECDH\nKey derivation: X25519(private, peer_public) → HKDF-SHA256 → AES-256-GCM",
      "properties" : {
        "LICENSE_ID" : {
                "type" : "string",
                "description" : "Unique license key identifier"
              },
        "PLUGIN_ID" : {
                "type" : "string",
                "description" : "Plugin ID this license is for"
              },
        "PLUGIN_VERSION" : {
                "type" : "string",
                "description" : "Plugin version or version range (semver)"
              },
        "LICENSEE_ORG" : {
                "type" : "string",
                "description" : "Licensee organization name"
              },
        "LICENSEE_EMAIL" : {
                "type" : "string",
                "description" : "Licensee contact email"
              },
        "LICENSEE_PEER_ID" : {
                "type" : "string",
                "description" : "Licensee's SDN Peer ID"
              },
        "LICENSEE_PUBKEY" : {
                "type" : "array", "items" : {"type" : "integer", "minimum" : 0, "maximum" :255},
                "description" : "Licensee's X25519 public key (32 bytes)"
              },
        "ISSUER_PUBKEY" : {
                "type" : "array", "items" : {"type" : "integer", "minimum" : 0, "maximum" :255},
                "description" : "Issuer's X25519 public key (32 bytes)\nUsed with licensee's private key to derive shared secret via ECDH"
              },
        "ALLOWED_DOMAINS" : {
                "type" : "array", "items" : {"type" : "string"},
                "description" : "Domain restrictions (empty = any domain allowed)"
              },
        "ALLOWED_TLDS" : {
                "type" : "array", "items" : {"type" : "string"},
                "description" : "TLD restrictions (e.g., \".gov\", \".mil\", \".edu\")"
              },
        "LICENSE_TYPE" : {
                "$ref" : "#/definitions/licenseType",
                "description" : "Type of license"
              },
        "MAX_ACTIVATIONS" : {
                "type" : "integer", "minimum" : 0, "maximum" : 4294967295,
                "description" : "Maximum concurrent activations (0 = unlimited)"
              },
        "ISSUED_AT" : {
                "type" : "integer", "minimum" : 0, "maximum" : 18446744073709551615,
                "description" : "Unix timestamp when license was issued"
              },
        "VALID_FROM" : {
                "type" : "integer", "minimum" : 0, "maximum" : 18446744073709551615,
                "description" : "Unix timestamp when license becomes valid"
              },
        "EXPIRES_AT" : {
                "type" : "integer", "minimum" : 0, "maximum" : 18446744073709551615,
                "description" : "Unix timestamp when license expires (0 = never expires)"
              },
        "ISSUER_PEER_ID" : {
                "type" : "string",
                "description" : "Peer ID of the license issuer (OrbPro)"
              },
        "SIGNATURE" : {
                "type" : "array", "items" : {"type" : "integer", "minimum" : 0, "maximum" :255},
                "description" : "Ed25519 signature from issuer over all fields (except SIGNATURE)"
              }
      },
      "required" : ["LICENSE_ID", "PLUGIN_ID", "LICENSEE_ORG"],
      "additionalProperties" : false
    }
  },
  "$ref" : "#/definitions/PLK"
}
